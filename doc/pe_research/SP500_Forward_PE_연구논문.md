# S&P 500 Forward P/E 평균회귀 현상과 시장 타이밍 전략에 관한 실증 연구

**A Study on Mean Reversion Properties of S&P 500 Forward P/E Ratio and Market Timing Strategy**

---

**저자:** 강승구 (Seung-Gu Kang)  
**연구기간:** 2025년 11월  
**데이터 기간:** 1988년 12월 ~ 2025년 9월 (37년, 분기별 148개 + 일별 9,003개)  
**최종 갱신:** 2025년 11월 13일

---

## Abstract

본 연구는 S&P 500 지수의 Forward P/E 배수가 미래 수익률을 예측하는 능력을 검증하고, 이를 활용한 실전 투자 전략을 제시한다. 37년간(1988-2025)의 데이터를 활용하여 Operating Earnings 기반 3가지 P/E 정의(TTM Operating, Mixed Operating, Forward Operating)의 예측력을 비교 분석하였다. 

먼저 Operating vs As Reported Earnings를 비교한 결과, Operating Earnings가 모든 기간에서 예측력이 우수함을 확인하였다 (12개월 상관계수: -0.620 vs -0.590). As Reported는 일회성 항목으로 인한 왜곡이 크며, 특히 2000년 닷컴버블, 2008년 금융위기, 2020년 팬데믹 위기 시 통계를 크게 왜곡하는 것으로 나타났다.

분기별 148개 데이터(1988-2025, 37년)로 기본 분석을 수행한 후, 일별 9,003개 데이터(동일 기간, 60배 증가)로 검증한 결과, Forward Operating [Q'(1)+Q'(2)+Q'(3)+Q'(4)]이 63.4%의 예측 정확도와 Low P/E가 High P/E 대비 15.31%p 높은 수익률을 제공하는 것으로 나타났다.

주요 발견사항은 다음과 같다:
1. **Operating Earnings 선택의 중요성:** As Reported 대비 일관되게 높은 예측력 (상관계수 차이 0.03~0.08)
2. **Forward Operating이 가장 우수:** Trailing 대비 3배 이상의 예측력 (상관계수 -0.533 vs -0.163)
3. P/E 하위 25% 구간은 연 15.91% 수익, 상위 25%는 0.60% 수익으로 25배 차이
4. **일별 데이터 검증(9,003개)으로 분기별 결과 재확인:** 상관계수 -0.62, 연율화 +15.61%로 일관된 예측력
5. **P/E ≈ 21이 결정적 임계점:** 37년 기준 20.8, 10년 기준 21.2로 일별 데이터에서도 재확인됨
6. **임계점 초과 시 수익률 급락:** P/E < 21: +13~17%, P/E ≥ 21: -4.5% (손실)
7. 현재 시장(P/E 22.72)은 임계점을 1.7pt 초과한 저수익/손실 구간
8. **Trailing-like Operating P/E의 시장 저점 포착 능력:** Trailing-like Operating [Q(-3)+Q(-2)+Q(-1)+Q(0)] P/E가 -1.5σ 이하로 하락할 때 주요 시장 저점을 효과적으로 식별 (백테스팅의 TTM Operating과는 다르며, Q(0)가 예측치일 수 있음)

본 연구의 진정한 의의는 **백테스팅에서는 강한 예측력을 보였던 P/E가, 실제 예상치를 사용한 환경에서는 거의 무의미한 수준으로 감소한다**는 것을 실증적으로 보여주는 것이다. 이는 "P/E가 높으면 고평가이므로 위험하고, 낮으면 저평가이므로 찬스다"라는 단순한 논리가 실제 투자 환경에서는 작동하지 않을 수 있음을 시사하며, 단일 지표에 의존한 투자 결정의 위험성을 경고한다는 점에서 학술적·실무적 의의를 갖는다 (자세한 내용은 6장 및 7장 참조).

**Keywords:** Forward P/E, Mean Reversion, Market Timing, S&P 500, Valuation Metrics, Predictive Analytics

---

## 목차 (Table of Contents)

### **1. 서론 (Introduction)**
- 1.1 연구 배경 및 동기
- 1.2 연구의 시작: 초기 문제 인식
- 1.3 연구 목적
- 1.4 연구의 독창성

### **2. 이론적 배경 (Theoretical Background)**
- 2.1 P/E 비율의 전통적 이해
- 2.2 Trailing vs Forward P/E 논쟁
- 2.3 본 연구의 출발점
- 2.4 EPS 정의 및 표기법
- 2.5 Operating vs As Reported Earnings
- 2.6 분석 대상 선정

### **3. 연구 방법론 (Methodology)**
- 3.1 백테스팅 방법론 (실측치 기반)
- 3.2 실제 예상치 검증 방법론
- 3.3 평가 지표

### **4. 백테스팅 결과: 실측치 기반 분석**
- 4.1 분기별 분석 결과
- 4.2 일별 분석 결과
- 4.3 주요 발견사항

### **5. 실제 검증: 예상치 기반 분석**
- 5.1 방법론 및 데이터
- 5.2 분석 결과
- 5.3 백분위별 분석
- 5.4 시장 타이밍 신호 분석: P/E 시그마 밴드와 시장 저점

### **6. 핵심 발견: 백테스팅 vs 실제 환경**
- 6.1 상관계수 비교
- 6.2 스프레드 비교
- 6.3 예측력 차이의 원인 분석
- 6.4 이것이 의미하는 것

### **7. 연구의 한계 및 함의**
- 7.1 백테스팅의 한계
- 7.2 실제 투자 환경에서의 의미
- 7.3 P/E 기반 단순 판단의 위험성

### **8. 결론: 연구의 진정한 의의**

---

## 1. 서론 (Introduction)

### 1.1 연구 배경 및 동기

주식시장의 밸류에이션 지표 중 P/E 비율(Price-to-Earnings Ratio)은 가장 널리 사용되는 지표이다. 그러나 실무에서는 여러 가지 P/E 정의가 혼재되어 사용되며, 각각의 예측력에 대한 체계적인 비교 연구는 부족한 실정이다.

본 연구는 다음과 같은 실무적 질문에서 출발하였다:

**"어떤 P/E 지표를 봐야 하는가?"**

이 질문은 단순해 보이지만, 실제로는 다음과 같은 세부 질문들을 포함한다:
- Trailing P/E(과거 실적 기반)와 Forward P/E(미래 전망 기반) 중 무엇이 더 유용한가?
- Forward P/E 내에서도 여러 정의가 있는데, 어느 것이 가장 예측력이 높은가?
- Operating Earnings와 As Reported Earnings 중 어느 것을 사용해야 하는가?

### 1.2 연구의 시작: 초기 문제 인식

본 연구는 실무 투자 과정에서 다음과 같은 문제를 발견하면서 시작되었다:

1. **EPS 정의의 다양성 발견:**
   - S&P Global의 공식 EPS 데이터에서 Operating vs As Reported 구분 발견
   - Forward P/E 내에서도 여러 정의 가능 (TTM, Mixed, Forward Operating)
   - 각 정의의 예측력 차이에 대한 체계적 연구 부재

2. **비교 분석:** 3가지 Operating P/E 정의의 예측력을 정량적으로 비교
   - TTM Operating (Trailing): Q(-3)+Q(-2)+Q(-1)+Q(0)
   - Mixed Operating: Q(0)+Q'(1)+Q'(2)+Q'(3)
   - Forward Operating: Q'(1)+Q'(2)+Q'(3)+Q'(4)

3. **실전 검증:** 실제 예상치를 사용한 환경에서의 예측력 검증

### 1.3 연구 목적

본 연구의 목적은 다음과 같다:

1. Operating Earnings 기반 3가지 P/E 정의의 예측력을 비교 분석
2. 백테스팅(실측치 기반)과 실제 투자 환경(예상치 기반)의 차이를 실증적으로 보여줌
3. P/E 기반 단순 판단의 위험성을 경고하고, 다각도 분석의 중요성을 강조

### 1.4 연구의 독창성

본 연구의 독창성은 다음과 같다:

1. **실측치 vs 예상치 비교:** 백테스팅 결과와 실제 예상치 기반 분석을 대조하여 예측력 차이를 정량화
2. **3가지 Operating P/E 정의 비교:** TTM, Mixed, Forward Operating의 예측력을 체계적으로 비교
3. **대규모 일별 데이터 검증:** 분기별 148개에서 일별 9,003개로 샘플 크기 60배 증가

---

## 2. 이론적 배경 (Theoretical Background)

### 2.1 P/E 비율의 전통적 이해

P/E 비율은 주가를 주당순이익(EPS)으로 나눈 값으로, 주식의 밸류에이션을 측정하는 가장 기본적인 지표이다. 전통적으로는 낮은 P/E가 저평가, 높은 P/E가 고평가를 의미한다고 해석된다.

### 2.2 Trailing vs Forward P/E 논쟁

- **Trailing P/E:** 과거 4분기 실적 기반 (TTM: Trailing Twelve Months)
- **Forward P/E:** 미래 4분기 예측 기반

일반적으로 Forward P/E가 더 미래 지향적이므로 예측력이 높을 것으로 예상되나, 실증 연구는 제한적이다.

### 2.3 본 연구의 출발점

본 연구는 S&P Global의 공식 EPS 데이터에서 Operating vs As Reported Earnings의 구분을 발견하면서 시작되었다. 이는 기존 연구에서 충분히 다루지 않은 영역이다.

### 2.4 EPS 정의 및 표기법

**실측/예측 구분:**
- **Q(n)**: Actuals (실측치) - 이미 보고된 실제 실적
- **Q'(n)**: Estimates (예측치) - 미래 분기에 대한 예측

**3가지 Operating P/E 정의:**
- **TTM Operating:** Q(-3) + Q(-2) + Q(-1) + Q(0) = 과거 3분기 실측치 + 현재 분기 실측치
- **Mixed Operating:** Q(0) + Q'(1) + Q'(2) + Q'(3) = 현재 분기 실측치 + 다음 3분기 예측치
- **Forward Operating:** Q'(1) + Q'(2) + Q'(3) + Q'(4) = 다음 4분기 예측치 (완전 미래 지향)

### 2.5 Operating vs As Reported Earnings

**Operating Earnings (조정 기준):**
- 일회성 항목 제외
- 지속 가능한 사업 성과만 반영

**As Reported Earnings (보고 기준):**
- 일회성 항목 포함
- 특수 상황 시 왜곡 가능

본 연구에서는 Operating Earnings가 모든 기간에서 예측력이 우수함을 확인하였다.

### 2.6 분석 대상 선정

본 연구는 Operating Earnings 기반 3가지 P/E 정의를 분석 대상으로 선정하였다:
1. TTM Operating
2. Mixed Operating
3. Forward Operating

---

## 3. 연구 방법론 (Methodology)

### 3.1 백테스팅 방법론 (실측치 기반)

#### 3.1.1 데이터 수집 및 전처리

**가격 데이터:**
- 출처: Yahoo Finance API (yfinance 라이브러리)
- 종목: S&P 500 지수 (^GSPC)
- 기간: 1985년 ~ 2025년 11월
- 빈도: 일별 종가

**가격 스무딩 처리 (분기별 분석에만 적용):**
분기별 분석에서는 분기말 특정 날짜의 급등락이 결과를 왜곡하는 것을 방지하기 위해, 분기말 전후 7일(총 14일 윈도우)의 평균 종가를 사용하였다.

**일별 분석:**
일별 데이터 검증에서는 매일의 실제 종가를 그대로 사용하며, 스무딩 처리를 하지 않는다.

**EPS 데이터:**
- 출처: S&P Global - S&P Dow Jones Indices
- Sheet: ESTIMATES&PEs
- 행 범위: 132-278 (1988년 12월 ~ 2025년 9월, 37년 전체 기간)

**분석 대상 EPS (모두 Operating Earnings 기준):**
1. **TTM Operating** = Q(-3) + Q(-2) + Q(-1) + Q(0) - 최근 4분기 실측치
2. **Mixed Operating** = Q(0) + Q'(1) + Q'(2) + Q'(3) - 실측 1Q + 예측 3Q
3. **Forward Operating** = Q'(1) + Q'(2) + Q'(3) + Q'(4) - 예측 4Q (완전 미래 지향)

**최종 데이터셋:**
- 분석 기간: 1988년 12월 ~ 2025년 9월 (37년)
- 총 관측치: 148 분기
- 각 EPS 컬럼별 유효 데이터: 148개 (결측치 없음)

#### 3.1.2 P/E 비율 계산

각 분기 $t$에 대해 P/E 비율을 다음과 같이 계산하였다:

$$
PE_t = \frac{Price_t}{EPS_t}
$$

여기서 $Price_t$는 분기 $t$의 스무딩된 평균 종가, $EPS_t$는 해당 분기의 EPS 추정치이다.

#### 3.1.3 Z-Score 정규화

P/E 비율의 절대값은 시대에 따라 변화하므로, Z-score로 정규화하여 상대적 고평가/저평가를 측정하였다:

$$
Z_t = \frac{PE_t - \mu_{PE}}{\sigma_{PE}}
$$

여기서:
- $\mu_{PE}$: 전체 기간 P/E 평균
- $\sigma_{PE}$: 전체 기간 P/E 표준편차

Z-score > 0은 평균 대비 고평가, Z-score < 0은 저평가를 의미한다.

#### 3.1.4 미래 수익률 계산

각 분기 $t$에서 $n$ 분기 후의 누적 수익률을 다음과 같이 계산:

$$
Return_{t,n} = \frac{Price_{t+n} - Price_t}{Price_t} \times 100\%
$$

본 연구에서는 $n = 1, 2, 3, 4$에 대해 분석하였다 (각각 3, 6, 9, 12개월 선행).

**연율화 (Annualization):**

기간이 다른 수익률을 비교하기 위해 연율화 변환을 수행한다:

$$
Annualized\_Return = Return_{t,n} \times \frac{4}{n}
$$

### 3.2 실제 예상치 검증 방법론

#### 3.2.1 데이터 수집

**예상치 데이터:**
- 출처: FactSet PDF에서 추출한 실제 예상치 데이터
- 기간: 2016년 12월 ~ 2025년 11월 (약 8년)
- 리포트 주기: 주간 (약 345개 리포트 날짜)

**가격 데이터:**
- 출처: Yahoo Finance API (yfinance 라이브러리)
- 일별 실제 종가 사용

#### 3.2.2 P/E 계산 방법

각 리포트 날짜의 EPS 예상치를 사용하여, 해당 리포트 날짜부터 다음 리포트 날짜 전까지의 매일 P/E를 계산:

- 리포트 날짜의 EPS 예상치를 고정
- 매일의 실제 가격으로 P/E 계산
- 다음 리포트가 나올 때까지 동일한 EPS 사용

#### 3.2.3 미래 수익률 계산

각 날짜에서 정확히 63일(1Q), 126일(2Q), 189일(3Q), 252일(4Q) 후의 실제 가격으로 수익률 계산:

$$
Return_{t,nQ} = \frac{Price_{t+nQ} - Price_t}{Price_t} \times 100\%
$$

여기서 $nQ$는 $n$ 분기 후의 날짜 (1Q = 63일, 4Q = 252일)이다.

### 3.3 평가 지표

#### 3.3.1 Pearson 상관계수

P/E와 미래 수익률 간의 선형 관계를 측정:

$$
r = \frac{\sum (Z_i - \bar{Z})(R_i - \bar{R})}{\sqrt{\sum (Z_i - \bar{Z})^2 \sum (R_i - \bar{R})^2}}
$$

음의 상관계수는 "P/E 높을 때 수익률 낮음"을 의미한다.

#### 3.3.2 예측 정확도 (Accuracy)

중앙값(median) 기준으로 수익률을 이분화하여 정확도 계산:

$$
Accuracy = \frac{\text{정확한 예측 개수}}{\text{전체 예측 개수}} \times 100\%
$$

#### 3.3.3 평균 수익률 차이 (스프레드)

실제 투자 의사결정에 가장 중요한 지표:

$$
\Delta Return = \overline{Return}_{Low} - \overline{Return}_{High}
$$

Low P/E 그룹과 High P/E 그룹의 평균 수익률 차이를 계산한다.

---

## 4. 백테스팅 결과: 실측치 기반 분석

### 4.1 분기별 분석 결과

#### 4.1.1 상관계수 분석

**Table 1: P/E Z-score와 미래 수익률 간 Pearson 상관계수**

| EPS 정의 | 구성 | 1Q (3mo) | 2Q (6mo) | 3Q (9mo) | 4Q (12mo) | **평균** |
|----------|------|----------|----------|----------|-----------|---------|
| **Forward Operating** | Q'(1)+Q'(2)+Q'(3)+Q'(4) | -0.413 | -0.538 | **-0.591** | -0.588 | **-0.533** ✅ |
| **Mixed Operating** | Q(0)+Q'(1)+Q'(2)+Q'(3) | -0.382 | -0.477 | -0.493 | -0.474 | **-0.457** |
| **TTM Operating** | Q(-3)+Q(-2)+Q(-1)+Q(0) | -0.106 | -0.147 | -0.189 | -0.212 | **-0.163** |

**주요 발견:**
1. **Forward Operating (Next 4Q 예측)이 가장 강한 음의 상관관계**를 보임 (평균 -0.533)
2. **특히 3-4분기 선행에서 -0.59로 최고치** 기록
3. **TTM Operating (Trailing)은 매우 약한 상관관계** (평균 -0.163)
4. 미래 지향적일수록 예측력 향상

#### 4.1.2 예측 정확도 분석

**Table 2: P/E 기반 수익률 예측 정확도 (중앙값 기준)**

| EPS 정의 | 구성 | 1Q | 2Q | 3Q | 4Q | **평균** | 해석 |
|----------|------|-----|-----|-----|-----|---------|------|
| **Forward Operating** | Q'(1)+Q'(2)+Q'(3)+Q'(4) | 56.5% | 62.3% | **63.4%** | 62.5% | **61.2%** | 강함 ✅ |
| **Mixed Operating** | Q(0)+Q'(1)+Q'(2)+Q'(3) | 57.8% | 59.6% | 59.3% | 55.6% | **58.1%** | 보통 |
| **TTM Operating** | Q(-3)+Q(-2)+Q(-1)+Q(0) | 46.9% | 48.6% | 52.4% | 51.4% | **49.8%** | 무용 ❌ |

**해석:**
- 50%는 동전 던지기 수준
- **Forward Operating (Next 4Q 예측)은 61-63% 정확도**로 통계적으로 유의미
- **TTM Operating (Trailing)은 49.8%로 동전 던지기와 다름없음**

#### 4.1.3 실제 수익률 차이 분석 (가장 중요)

**Table 3: Low P/E vs High P/E 그룹의 평균 1년 수익률 비교**

| EPS 정의 | 구성 | High P/E (Z>0) | Low P/E (Z<0) | **차이** | 샘플 (H/L) |
|----------|------|----------------|---------------|---------|-----------|
| **Forward Operating** | Q'(1)+Q'(2)+Q'(3)+Q'(4) | +0.60% | +15.91% | **+15.31%p** ✅ | 56 / 88 |
| **Mixed Operating** | Q(0)+Q'(1)+Q'(2)+Q'(3) | +4.60% | +14.00% | **+9.39%p** | 62 / 82 |
| **TTM Operating** | Q(-3)+Q(-2)+Q(-1)+Q(0) | +7.69% | +11.57% | **+3.87%p** | 60 / 84 |

**핵심 발견:**
1. **Forward Operating (Next 4Q 예측)은 25배 수익률 차이**를 보임 (15.91% vs 0.60%)
2. High P/E 구간에서는 거의 현금 수준의 수익 (0.60%)
3. Low P/E 구간에서는 연 16% 근처의 강한 수익
4. **TTM Operating (Trailing)은 차별력이 약함 (3.87%p), Forward 대비 1/4 수준**

#### 4.1.4 연율화 분석: 기간 효과 제거

**Table 3-1: Forward Operating (Q'(1)+Q'(2)+Q'(3)+Q'(4)) - 기간별 수익률 차이 및 연율화 비교 (37년)**

| 기간 | Low P/E 평균 | High P/E 평균 | **차이** | **연율화 차이** |
|-----|------------|--------------|---------|--------------|
| 1Q (3개월) | +4.12% | +0.04% | +4.07% | **+16.28% / 년** |
| 2Q (6개월) | +8.14% | +0.14% | +8.00% | **+16.00% / 년** |
| 3Q (9개월) | +12.03% | +0.27% | +11.76% | **+15.68% / 년** |
| 4Q (12개월) | +15.91% | +0.60% | +15.31% | **+15.31% / 년** |

**발견:**
- 연율화하면 모든 기간에서 **Low P/E가 High P/E 대비 연 15-16%p 높은 수익**으로 일관됨
- 절대 수익률이 기간에 따라 증가하는 것은 **시간 효과**
- P/E의 진짜 예측력은 **Low vs High 수익률 차이 연 15-16%p**

**Table 3-2: 3가지 Operating P/E의 연율화 수익률 차이 비교 (37년, 148분기)**

| EPS 정의 | 구성 | 1Q→연율화 | 2Q→연율화 | 3Q→연율화 | 4Q→연율화 | **평균** | 일관성 |
|---------|------|----------|----------|----------|----------|---------|--------|
| **Forward Operating** | Q'(1)+Q'(2)+Q'(3)+Q'(4) | +16.29% | +16.00% | +15.68% | +15.31% | **+15.82%** | ✅ 매우 일관 |
| **Mixed Operating** | Q(0)+Q'(1)+Q'(2)+Q'(3) | +14.33% | +12.38% | +11.08% | +9.39% | **+11.80%** | △ 변동 있음 |
| **TTM Operating** | Q(-3)+Q(-2)+Q(-1)+Q(0) | +1.15% | +1.53% | +3.35% | +3.87% | **+2.47%** | ❌ 거의 무용 |

**결론:**
- **Forward Operating은 예측력이 높을 뿐 아니라 가장 안정적**
- Mixed Operating도 나쁘지 않지만 (11.8%/년) 기간별 변동이 큼 (변동폭 4.94%p)
- **Forward Operating을 사용해야 하는 이유: 높은 예측력 + 일관성**

**Figure 2-1: Forward Operating 평균회귀 분석 (분기별, 최고 성능)**

![Figure 2-1: Forward Operating](https://pub-8ab005469c4042798a7550efc290ac49.r2.dev/charts/pe_mean_reversion_M_1762956822.jpg)

**Figure 2-2: Mixed Operating 평균회귀 분석 (분기별)**

![Figure 2-2: Mixed Operating](https://pub-8ab005469c4042798a7550efc290ac49.r2.dev/charts/pe_mean_reversion_L_1762956822.jpg)

**Figure 2-3: TTM Operating 평균회귀 분석 (분기별, Trailing)**

![Figure 2-3: TTM Operating](https://pub-8ab005469c4042798a7550efc290ac49.r2.dev/charts/pe_mean_reversion_I_1762956823.jpg)

### 4.2 일별 분석 결과

#### 4.2.1 연구 동기

앞선 분기별 분석은 148개의 관측치를 사용하였다. 통계적 신뢰도를 높이기 위해, **일별(daily) 가격 데이터를 활용한 검증 분석**을 추가로 수행하였다.

**핵심 질문:**
- 샘플 크기를 60배 증가시키면 (148 → 9,003) 결과가 달라지는가?
- 일별 데이터의 노이즈가 신호를 희석시키는가, 아니면 더 정밀한 추정이 가능한가?

#### 4.2.2 방법론: 일별 데이터 매핑

**EPS-가격 매핑 로직:**

```
각 날짜가 속한 분기의 끝 날짜 EPS를 사용

예시:
┌────────────────────────────────────────────────────────────────┐
│ 기간: 2025-07-01 ~ 2025-09-30 (Q3)                              │
│ 사용 EPS: 2025-09-30 행의 값                                      │
│                                                                │
│ 각 변수별 EPS 구성 (Q' = 예측, Q = 실측):                            │
│   - Forward Operating:  294.11 = Q'(1)+Q'(2)+Q'(3)+Q'(4)       │
│                                   (Q4'+2026Q1'+Q2'+Q3')        │
│   - Mixed Operating:    288.10 = Q(0)+Q'(1)+Q'(2)+Q'(3)        │
│                                   (Q3'+Q4'+2026Q1'+Q2')        │
│   - TTM Operating:      255.80 = Q(-3)+Q(-2)+Q(-1)+Q(0)        │
│                                   (2024Q4+Q1+Q2+Q3')           │
│                                                                │
│ 매일의 P/E 계산 예시 (Forward Operating):                          │
│   - 2025-07-01: P/E = 5,475 ÷ 294.11 = 18.61                   │
│   - 2025-07-02: P/E = 5,480 ÷ 294.11 = 18.63                   │
│   - 2025-09-30: P/E = 5,738 ÷ 294.11 = 19.51                   │
└────────────────────────────────────────────────────────────────┘
```

**데이터 규모:**
- 분기별: 148 data points
- 일별: **9,003 data points** (60.8배 증가)
- 표준오차: **8배 감소** (0.083 → 0.010)

#### 4.2.3 결과 1: 상관계수 비교

**Table 4-1: 분기별 vs 일별 상관계수 비교 (Operating Earnings 기준)**

| 변수 | 데이터 | 1Q | 2Q | 3Q | 4Q | **평균** |
|------|--------|-----|-----|-----|-----|---------|
| **Forward Operating** | 분기별 | -0.413 | -0.538 | -0.591 | -0.588 | **-0.533** |
| **Forward Operating** | 일별 | -0.395 | -0.544 | **-0.609** | **-0.623** | **-0.543** |
| **Forward Operating** | 차이 | +0.018 | -0.006 | **-0.018** | **-0.035** | **-0.010** |
| **Mixed Operating** | 분기별 | -0.382 | -0.477 | -0.493 | -0.474 | **-0.457** |
| **Mixed Operating** | 일별 | -0.402 | -0.515 | -0.546 | -0.532 | **-0.499** |
| **TTM Operating** | 분기별 | -0.106 | -0.147 | -0.189 | -0.212 | **-0.164** |
| **TTM Operating** | 일별 | -0.145 | -0.184 | -0.210 | -0.234 | **-0.193** |

**핵심 발견:**
1. **Forward Operating: 일별 데이터에서 4Q 상관계수 개선** (-0.588 → -0.623, +6%)
2. **Mixed Operating: 모든 기간에서 일관된 개선** (평균 +9%)
3. **TTM Operating: 약한 신호도 더 명확해짐** (+18% 개선)

**Figure 3: Forward Operating 일별 데이터 평균회귀 분석 (9,003개 분석 샘플)**

![Figure 3: Daily Forward Operating](https://pub-8ab005469c4042798a7550efc290ac49.r2.dev/charts/pe_mean_reversion_daily_M_1762971064.jpg)

*일별 데이터 9,003개로 분석한 Forward Operating의 P/E 시계열 및 미래 수익률 상관관계. Mixed Operating과 TTM Operating의 차트는 유사한 패턴을 보이나 상관계수가 낮아 생략함.*

#### 4.2.4 결과 2: 연율화 수익률 차이 비교

**Table 4-2: 연율화 수익률 차이 (Low P/E - High P/E) - 분기별 vs 일별 (Forward Operating)**

| 변수 | 데이터 | 1Q→Ann | 2Q→Ann | 3Q→Ann | 4Q(실제) | **평균** |
|------|--------|--------|--------|--------|----------|---------|
| **Forward Operating** | 분기별 | +17.33% | +16.67% | +15.99% | **+15.31%** | +16.33% |
| **Forward Operating** | 일별 | +16.99% | +15.86% | +15.22% | **+14.37%** | +15.61% |
| **Forward Operating** | 차이 | -0.34% | -0.81% | -0.77% | -0.94% | **-0.72%** |

**핵심 발견:**
1. **4Q(실제 1년)가 연율화 정확성의 기준:** 
   - 분기별 4Q = +15.31% (실제값)
   - 일별 4Q = +14.37% (0.94%p 차이)

2. **분기별 데이터의 우수성:**
   - 분기별 평균(+16.33%)이 일별(+15.61%)보다 실제(+15.31%)에 더 가까움
   - 일별은 단기 노이즈로 약간 underestimate

#### 4.2.5 결과 3: P/E 구간별 수익률 (37년 vs 10년)

**Table 4-3: Forward Operating - P/E 구간별 수익률 비교 (일별 데이터)**

| 기간 | 구간 | P/E 범위 | 평균 수익률 | 샘플 수 |
|------|------|----------|------------|---------|
| **37년** | Bottom 25% | **< 14.6** | **+16.90%** | 2,267 |
| **37년** | 25-50% | 14.6 - 17.2 | +14.36% | 2,266 |
| **37년** | 50-75% | 17.2 - 20.8 | +12.88% | 2,266 |
| **37년** | Top 25% | **≥ 20.8** | **-4.53%** | 2,267 |
| **37년** | **Spread** | - | **+21.43%p** | - |
| **10년** | Bottom 25% | **< 17.7** | **+20.31%** | 613 |
| **10년** | 25-50% | 17.7 - 18.9 | +16.36% | 612 |
| **10년** | 50-75% | 18.9 - 21.2 | +10.69% | 612 |
| **10년** | Top 25% | **≥ 21.2** | **+2.44%** | 613 |
| **10년** | **Spread** | - | **+17.87%p** | - |

**핵심 발견:**

1. **P/E ≈ 21의 특이점 재확인:**
   - 37년: P/E 20.8 이상 → **-4.53%** (손실!)
   - 10년: P/E 21.2 이상 → +2.44% (저수익)
   - **평균: P/E ≈ 21 = 결정적 임계점**

2. **뉴노멀 효과:**
   - P/E 중앙값: 17.2 → 18.9 (+1.7pt 상승)
   - 저금리 환경으로 전반적인 P/E 상승
   - 하지만 **임계점(21)은 여전히 유효**

**Figure 4: Forward Operating P/E vs 1년 수익률 상관관계 (일별 데이터, 9,003개 분석 샘플)**

![Figure 4: Correlation](https://pub-8ab005469c4042798a7550efc290ac49.r2.dev/charts/pe_correlation_M_1762971065.jpg)

*9,003개 일별 데이터로 확인한 P/E와 1년 수익률의 강한 음의 상관관계 (r = -0.62)*

### 4.3 주요 발견사항

백테스팅 결과를 요약하면:

1. **Forward Operating P/E가 가장 우수한 예측력을 보임**
   - 상관계수: -0.533 (분기별), -0.623 (일별 4Q)
   - 예측 정확도: 61-63%
   - 스프레드: +15.31%p (분기별), +14.37%p (일별)

2. **P/E ≈ 21이 결정적 임계점**
   - 37년 기준: P/E 20.8
   - 10년 기준: P/E 21.2
   - 임계점 초과 시 수익률 급락 (-4.65% ~ +2.44%)

3. **일별 데이터로 분기별 결과 재확인**
   - 샘플 크기 60배 증가 (148 → 9,003)
   - 결과 일관성 확인

---

## 5. 실제 검증: 예상치 기반 분석

### 5.1 방법론 및 데이터

#### 5.1.1 데이터 수집

**예상치 데이터:**
- 출처: FactSet PDF에서 추출한 실제 예상치 데이터
- 기간: 2016년 12월 ~ 2025년 11월 (약 8년)
- 리포트 주기: 주간 (약 345개 리포트 날짜)
- 특징: 실제 미래 예상치(*) 사용

**가격 데이터:**
- 출처: Yahoo Finance API (yfinance 라이브러리)
- 일별 실제 종가 사용
- 총 거래일: 약 22,358개

#### 5.1.2 P/E 계산 방법

각 리포트 날짜의 EPS 예상치를 사용하여, 해당 리포트 날짜부터 다음 리포트 날짜 전까지의 매일 P/E를 계산:

- 리포트 날짜의 EPS 예상치를 고정
- 매일의 실제 가격으로 P/E 계산
- 다음 리포트가 나올 때까지 동일한 EPS 사용

이는 실제 투자 환경과 유사한 방식이다.

#### 5.1.3 미래 수익률 계산

각 날짜에서 정확히 63일(1Q), 126일(2Q), 189일(3Q), 252일(4Q) 후의 실제 가격으로 수익률 계산:

$$
Return_{t,nQ} = \frac{Price_{t+nQ} - Price_t}{Price_t} \times 100\%
$$

여기서 $nQ$는 $n$ 분기 후의 날짜 (1Q = 63일, 4Q = 252일)이다.

### 5.2 분석 결과

#### 5.2.1 상관계수 분석

**Table 5-1: 실제 예상치 기반 P/E와 미래 수익률 상관계수 (2016-2025, 8년)**

| P/E 타입 | 1Q | 2Q | 3Q | 4Q | 샘플 수 |
|---------|-----|-----|-----|-----|---------|
| **Forward Operating** | -0.080 | -0.068 | -0.081 | **-0.132** | 20,177 |
| **Mixed Operating** | -0.053 | -0.036 | -0.040 | **-0.086** | 20,177 |
| **TTM Operating** | -0.041 | -0.017 | -0.026 | **-0.087** | 20,177 |

**핵심 발견:**
- 실제 예상치 기반에서는 상관계수가 **급격히 감소**
- Forward Operating: -0.132 (백테스팅: -0.623, 약 79% 감소)
- Mixed Operating: -0.086 (백테스팅: -0.532, 약 84% 감소)
- TTM Operating: -0.087 (백테스팅: -0.234, 약 63% 감소)

#### 5.2.2 백분위별 분석

**Table 5-2: 실제 예상치 기반 백분위별 수익률 (Forward Operating PE, 4Q 기준)**

| 백분위 구간 | P/E 범위 | 1Q 후 수익률 | 2Q 후 수익률 | 3Q 후 수익률 | 4Q 후 수익률 |
|-------------|----------|-------------|-------------|-------------|-------------|
| Bottom 25% | 12.37 - 17.76 | 2.78% | 5.07% | 6.95% | 9.99% |
| 25-50% | 17.76 - 20.27 | 2.39% | 5.48% | 9.73% | 12.32% |
| 50-75% | 20.27 - 21.76 | 3.35% | 5.96% | 7.49% | 8.16% |
| Top 25% | 21.76 - 24.79 | 1.44% | 3.71% | 5.51% | 8.00% |
| **스프레드 (Bottom-Top)** | - | **+1.34%p** | **+1.35%p** | **+1.44%p** | **+1.99%p** |

**Table 5-3: 실제 예상치 기반 백분위별 수익률 (Mixed Operating PE, 4Q 기준)**

| 백분위 구간 | P/E 범위 | 1Q 후 수익률 | 2Q 후 수익률 | 3Q 후 수익률 | 4Q 후 수익률 |
|-------------|----------|-------------|-------------|-------------|-------------|
| Bottom 25% | 12.73 - 18.23 | 2.63% | 4.89% | 6.75% | 9.75% |
| 25-50% | 18.23 - 20.98 | 2.44% | 5.46% | 9.68% | 12.23% |
| 50-75% | 20.98 - 22.63 | 3.01% | 5.50% | 6.47% | 6.71% |
| Top 25% | 22.63 - 27.73 | 1.90% | 4.46% | 7.01% | 9.92% |
| **스프레드 (Bottom-Top)** | - | **+0.73%p** | **+0.43%p** | **-0.26%p** | **-0.16%p** |

**Table 5-4: 실제 예상치 기반 백분위별 수익률 (TTM Operating PE, 4Q 기준)**

| 백분위 구간 | P/E 범위 | 1Q 후 수익률 | 2Q 후 수익률 | 3Q 후 수익률 | 4Q 후 수익률 |
|-------------|----------|-------------|-------------|-------------|-------------|
| Bottom 25% | 13.54 - 19.24 | 3.13% | 5.19% | 6.82% | 10.38% |
| 25-50% | 19.24 - 22.44 | 1.74% | 4.49% | 8.98% | 11.50% |
| 50-75% | 22.44 - 24.72 | 3.28% | 6.14% | 7.25% | 6.19% |
| Top 25% | 24.72 - 29.11 | 1.83% | 4.49% | 6.87% | 10.35% |
| **스프레드 (Bottom-Top)** | - | **+1.30%p** | **+0.70%p** | **-0.05%p** | **+0.02%p** |

### 5.3 백분위별 분석 요약

**Table 5-5: 실제 예상치 기반 스프레드 요약 (Bottom 25% - Top 25%)**

| P/E 타입 | 1Q 스프레드 | 2Q 스프레드 | 3Q 스프레드 | 4Q 스프레드 |
|---------|------------|------------|------------|------------|
| Forward Operating | +1.34%p | +1.35%p | +1.44%p | +1.99%p |
| Mixed Operating | +0.73%p | +0.43%p | -0.26%p | -0.16%p |
| TTM Operating | +1.30%p | +0.70%p | -0.05%p | +0.02%p |

**핵심 발견:**
- 실제 예상치 기반에서는 스프레드가 **급격히 감소**
- Forward Operating: +1.99%p (백테스팅: +20.68%p, 약 90% 감소)
- Mixed Operating: -0.16%p (음수, 역전 현상)
- TTM Operating: +0.02%p (거의 무의미)

### 5.4 시장 타이밍 신호 분석: P/E 시그마 밴드와 시장 저점

#### 5.4.1 분석 방법론

실제 예상치 기반 일별 데이터를 활용하여 세 가지 P/E 정의(Mixed Operating [Q(0)+Q'(1)+Q'(2)+Q'(3)], Trailing-like Operating [Q(-3)+Q(-2)+Q(-1)+Q(0)], Forward Operating [Q'(1)+Q'(2)+Q'(3)+Q'(4)])의 시계열을 S&P 500 주가와 함께 시각화하고, 각 P/E의 평균과 표준편차를 기준으로 ±1σ 및 ±1.5σ 범위를 벗어나는 구간을 강조하였다.

**참고:** 여기서 사용하는 Trailing-like Operating [Q(-3)+Q(-2)+Q(-1)+Q(0)]은 백테스팅에서 사용한 TTM Operating과는 다르다. 백테스팅의 TTM Operating은 Q(-3), Q(-2), Q(-1), Q(0) 모두 실측치였지만, 실제 예상치 기반 분석에서는 Q(0)가 현재 진행 중인 분기로 예측치일 수 있다. 따라서 완전히 결과론적이지 않으며, 실측치와 예측치가 혼합된 형태이다.

**분석 기간:** 2016년 12월 ~ 2025년 11월 (약 9년)
**데이터 포인트:** 일별 거래일 기준 (약 2,200~2,400개)

#### 5.4.2 시각적 분석 결과

**Figure 5: S&P 500 주가와 모든 P/E 비율 (±1σ 범위 강조)**

![Figure 5: S&P 500 Price with All P/E Ratios (±1σ)](output/sp500_price_with_all_pe_sigma.png)

*세 가지 P/E 정의(Mixed Operating [Q(0)+Q'(1)+Q'(2)+Q'(3)], Trailing-like Operating [Q(-3)+Q(-2)+Q(-1)+Q(0)], Forward Operating [Q'(1)+Q'(2)+Q'(3)+Q'(4)])를 각각 별도의 서브플롯으로 표시. 각 서브플롯은 S&P 500 주가(검은색 선)와 해당 P/E 비율(색상별 선)을 함께 보여주며, P/E가 ±1σ 범위를 벗어나는 구간을 빨간색(상단) 및 파란색(하단) 음영으로 강조.*

**Figure 6: S&P 500 주가와 모든 P/E 비율 (±1.5σ 범위 강조)**

![Figure 6: S&P 500 Price with All P/E Ratios (±1.5σ)](output/sp500_price_with_all_pe_sigma_1_5.png)

*동일한 구조로 ±1.5σ 범위를 벗어나는 구간을 강조. 더 엄격한 기준으로 극단적 가치 평가 구간을 식별.*

#### 5.4.3 주요 발견: Trailing-like Operating P/E의 시장 저점 포착 능력

**핵심 발견:**

세 가지 P/E 정의를 비교 분석한 결과, **Trailing-like Operating [Q(-3)+Q(-2)+Q(-1)+Q(0)] P/E가 -1.5σ 이하로 하락하는 구간은 주요 시장 저점을 효과적으로 식별**하는 것으로 나타났다.

**관찰된 패턴:**

1. **2018년 말 ~ 2019년 초 저점:**
   - Trailing-like Operating P/E가 -1.5σ 이하로 하락
   - S&P 500 주가의 주요 저점과 일치

2. **2020년 초 COVID-19 저점:**
   - Trailing-like Operating P/E가 -1.5σ 이하로 하락
   - 시장의 급격한 하락 후 반등 지점과 일치

3. **2022년 중반 저점:**
   - Trailing-like Operating P/E가 -1.5σ 이하로 하락
   - 인플레이션 우려로 인한 시장 조정의 저점과 일치

**Trailing-like Operating P/E의 특성:**

- **구성:** Q(-3) + Q(-2) + Q(-1) + Q(0) = 과거 3분기 실측치 + 현재 분기 예측치
- **백테스팅의 TTM Operating과의 차이점:**
  - 백테스팅의 TTM Operating: Q(-3), Q(-2), Q(-1), Q(0) 모두 실측치 (완전히 결과론적)
  - 실제 예상치 기반의 Trailing-like Operating: Q(-3), Q(-2), Q(-1)은 실측치이지만, Q(0)는 현재 진행 중인 분기로 예측치일 수 있음
- **특징:** 
  - 완전히 결과론적이지 않으며, 실측치와 예측치가 혼합된 형태
  - 예상치 기반 P/E에 비해 예상치 오차의 영향을 상대적으로 덜 받음 (과거 3분기는 실측치이므로)
- **장점:** 과거 실적을 주로 반영하면서도 현재 분기의 예측을 포함하여 시장의 과도한 비관을 포착하는 데 유리

**다른 P/E 정의와의 비교:**

수치적 분석 결과(MDD 극소점 기준, MDD < -8% 구간에서 다음 신고가 갱신되기 전까지의 가장 깊은 하락), 세 가지 P/E 정의 모두 MDD 최하점과의 일치성을 보였으나 각각 다른 특성을 가진다:

**Table 5-6: P/E -1.5σ 구간과 MDD 극소점 일치율 (±3일 윈도우)**

| P/E 정의 | -1.5σ 구간 수 | MDD 극소점 수 | 일치 구간 수 | 일치율 |
|---------|-------------|------------|------------|--------|
| **Mixed Operating** | 28 | 7 | 6 | **21.4%** |
| **Trailing-like Operating** | 21 | 7 | 7 | **33.3%** |
| **Forward Operating** | 28 | 7 | 6 | **21.4%** |

- **Mixed Operating [Q(0)+Q'(1)+Q'(2)+Q'(3)]:** 
  - -1.5σ 구간과 MDD 극소점 일치율: 21.4% (28개 구간 중 6개 일치)
  - 현재 분기 예측치 + 미래 3분기 예측치로 구성되어 비교적 잘 포착하나, -1.5σ 구간이 많아 노이즈가 상대적으로 많음

- **Trailing-like Operating [Q(-3)+Q(-2)+Q(-1)+Q(0)]:**
  - -1.5σ 구간과 MDD 극소점 일치율: **33.3%** (21개 구간 중 7개 일치, **최고 성능**)
  - 가장 적은 수의 -1.5σ 구간(21개)을 가지며, **모든 MDD 극소점(7개)이 -1.5σ 구간과 일치**
  - 노이즈가 가장 적어 중요한 시장 저점을 가장 선명하게 식별
  - 과거 실측치 비중이 높아 예상치 오차의 영향을 상대적으로 덜 받음

- **Forward Operating [Q'(1)+Q'(2)+Q'(3)+Q'(4)]:**
  - -1.5σ 구간과 MDD 극소점 일치율: 21.4% (28개 구간 중 6개 일치)
  - Mixed Operating과 동일한 일치율이나, -1.5σ 구간이 많아 노이즈가 상대적으로 많음
  - 미래 4분기 예상치만 사용하여 데이터 가용성 문제로 인해 일부 구간에서 분석 불가

**실무적 함의:**

Trailing-like Operating P/E가 -1.5σ 이하로 하락하는 구간은 시장의 극단적 비관을 나타내며, 역사적으로 주요 저점과 일치하는 경향을 보인다. 이는 다음과 같은 실무적 활용 가능성을 시사한다:

1. **시장 저점 식별:** Trailing-like Operating P/E가 -1.5σ 이하로 하락할 때 시장 저점 가능성 고려
2. **매수 타이밍:** 극단적 저평가 구간에서의 매수 기회 탐색
3. **리스크 관리:** 다른 지표와 함께 종합적으로 판단하여 과도한 비관 구간에서의 투자 기회 평가

**주의사항:**

- 단일 지표에 의존하지 말고 다른 지표와 종합적으로 판단해야 함
- -1.5σ 이하 하락이 항상 즉각적인 반등을 의미하는 것은 아님
- 시장 구조적 변화나 블랙스완 이벤트 시 패턴이 깨질 수 있음

---

## 6. 핵심 발견: 백테스팅 vs 실제 환경

### 6.1 상관계수 비교

**Table 6-1: 백테스팅 vs 실제 환경 상관계수 비교 (Forward Operating, 4Q 기준)**

| 환경 | 상관계수 | 샘플 수 | 데이터 기간 |
|------|---------|---------|------------|
| **백테스팅 (실측치)** | **-0.623** | 9,003 | 1988-2025 (37년) |
| **실제 환경 (예상치)** | **-0.132** | 20,177 | 2016-2025 (8년) |
| **차이** | **-0.491** | - | - |
| **감소율** | **약 79% 감소** | - | - |

**Table 6-2: 백테스팅 vs 실제 환경 상관계수 비교 (전체 P/E 타입, 4Q 기준)**

| P/E 타입 | 백테스팅 | 실제 환경 | 차이 | 감소율 |
|---------|---------|----------|------|--------|
| **Forward Operating** | -0.623 | -0.132 | -0.491 | 79% |
| **Mixed Operating** | -0.532 | -0.086 | -0.446 | 84% |
| **TTM Operating** | -0.234 | -0.087 | -0.147 | 63% |

**핵심 발견:**
- 모든 P/E 타입에서 실제 환경의 상관계수가 **급격히 감소**
- Forward Operating의 감소율이 가장 크지만, 절대값은 여전히 가장 높음
- 실제 환경에서는 P/E와 미래 수익률 간의 관계가 거의 무의미한 수준

### 6.2 스프레드 비교

**Table 6-3: 백테스팅 vs 실제 환경 스프레드 비교 (Bottom 25% - Top 25%, 4Q 기준)**

| P/E 타입 | 백테스팅 | 실제 환경 | 차이 | 감소율 |
|---------|---------|----------|------|--------|
| **Forward Operating** | +20.68%p | +1.99%p | -18.69%p | 90% |
| **Mixed Operating** | +15.84%p | -0.16%p | -16.00%p | 101% (역전) |
| **TTM Operating** | +4.16%p | +0.02%p | -4.14%p | 100% |

**핵심 발견:**
- 스프레드가 **90-100% 감소**
- Mixed Operating과 TTM Operating은 음수로 전환되어 **역효과 발생**
- Forward Operating만 양수이지만, 백테스팅 대비 **90% 감소**

### 6.3 예측력 차이의 원인 분석

#### 6.3.1 예상치 오차의 영향

백테스팅에서는 이미 발생한 실측치를 사용하여 "완벽한 예측"을 가정했지만, 실제 환경에서는:

1. **예상치의 오차가 P/E 계산에 반영됨**
   - 예상치가 부정확하면 P/E 계산도 부정확해짐
   - 부정확한 P/E는 미래 수익률과의 관계를 왜곡시킴

2. **예상치 오차가 클수록 P/E와 미래 수익률 간의 관계가 왜곡됨**
   - 예상치가 실제보다 높으면 P/E가 낮게 계산됨
   - 예상치가 실제보다 낮으면 P/E가 높게 계산됨
   - 이러한 왜곡이 예측력을 약화시킴

3. **결과적으로 P/E 기반 예측력이 급격히 감소**
   - 상관계수: -0.623 → -0.132 (79% 감소)
   - 스프레드: +20.68%p → +1.99%p (90% 감소)

#### 6.3.2 백테스팅의 한계

백테스팅은 다음과 같은 한계를 가진다:

1. **"완벽한 예측" 가정**
   - 이미 발생한 실측치를 사용
   - 실제 투자 환경에서는 불가능

2. **과도하게 낙관적인 결과**
   - 예상치 오차를 고려하지 않음
   - 실제 예측력보다 높게 나타남

3. **실전 적용의 어려움**
   - 백테스팅에서 좋은 성과를 보인 전략이라도 실제 환경에서는 다를 수 있음

### 6.4 이것이 의미하는 것

#### 6.4.1 P/E 기반 단순 판단의 위험성

실제 예상치를 사용한 분석 결과는 다음과 같은 함의를 가진다:

**❌ 피해야 할 접근:**
- "P/E가 25이면 고평가이므로 매도해야 한다"
- "P/E가 15이면 저평가이므로 매수해야 한다"
- 단순히 P/E 수치만 보고 투자 결정

**✅ 권장되는 접근:**
- P/E는 참고 지표일 뿐, 절대적 판단 기준이 아님
- 예상치의 정확도와 신뢰성을 함께 고려
- 다른 지표(기업 성장성, 산업 동향, 거시 환경 등)와 종합적으로 판단
- P/E가 높다고 무조건 위험한 것은 아니며, 낮다고 무조건 기회인 것도 아님

#### 6.4.2 백테스팅 결과의 한계 인식

본 연구는 다음과 같은 중요한 교훈을 제공한다:

1. **백테스팅 결과를 맹신하지 말아야 함**
   - 백테스팅에서 좋은 성과를 보인 전략이라도 실제 환경에서는 다를 수 있음
   - 예상치 오차를 고려하지 않은 백테스팅은 과도하게 낙관적인 결과를 보일 수 있음

2. **다각도 분석의 중요성**
   - 단일 지표(P/E)에 의존하지 말고 다양한 지표와 정보를 종합적으로 고려
   - 예상치의 정확도와 신뢰성을 함께 평가

3. **투자 철학의 재검토**
   - "고평가/저평가"라는 단순한 이분법적 사고의 한계
   - 시장은 복잡하며, 단일 지표로 모든 것을 설명할 수 없음

---

## 7. 연구의 한계 및 함의

### 7.1 백테스팅의 한계

#### 7.1.1 백테스팅 데이터의 한계: 실측치 vs 예상치

**핵심 문제:**

본 연구는 **과거 실측치(Actuals)를 사용한 백테스팅**을 기반으로 수행되었다. 이는 연구 방법론상 필수적인 접근이었으나, **실제 투자 환경에서는 미래 예상치(Estimates)를 사용해야 한다**는 근본적인 한계를 내포하고 있다.

**실측치 기반 백테스팅의 결과:**
- Forward Operating P/E와 4Q 후 수익률의 상관계수: **-0.623** (37년 데이터, 9,003개 일별 샘플)
- Bottom 25% vs Top 25% 스프레드: **+20.68%p** (37년 기준)
- P/E < 21 구간 평균 수익률: **+16.03%**
- P/E ≥ 21 구간 평균 수익률: **-4.65%** (손실)

**실제 예상치 기반 분석 결과 (2016-2025, 8년):**
- Forward Operating P/E와 4Q 후 수익률의 상관계수: **-0.132** (20,177개 일별 샘플)
- Bottom 25% vs Top 25% 스프레드: **+1.99%p** (4Q 기준)
- Mixed Operating P/E 스프레드: **-0.16%p** (음수, 역전 현상)
- TTM Operating P/E 스프레드: **+0.02%p** (거의 무의미)

**결론:**

실제 예상치를 사용한 분석 결과, 백테스팅에서 발견된 강한 음의 상관관계(-0.623)와 큰 스프레드(+20.68%p)는 **실제 투자 환경에서는 거의 무의미한 수준**으로 감소한다. 특히:

1. **상관계수 감소:** -0.623 → -0.132 (약 79% 감소)
2. **스프레드 감소:** +20.68%p → +1.99%p (약 90% 감소)
3. **예측력 상실:** Mixed Operating과 TTM Operating의 경우 스프레드가 음수로 전환되어 오히려 역효과 발생

이는 **예상치의 오차**가 P/E 계산에 반영되면서, P/E와 미래 수익률 간의 관계가 왜곡되기 때문이다. 백테스팅에서는 이미 발생한 실측치를 사용하여 "완벽한 예측"을 가정했지만, 실제 환경에서는 예상치의 불확실성이 예측력을 크게 약화시킨다.

#### 7.1.2 샘플 크기

**분기별 분석의 한계 (초기 연구):**
- 37년 = 148분기, 10년 = 40분기
- 일부 구간(극단값)은 n < 10으로 통계적 검정력 제한
- 특히 10년 데이터의 극단 구간은 n = 4-6 수준

**일별 데이터로 해결:**
- ✅ **37년 = 9,003개 (60배 증가)**
- ✅ **10년 = 2,452개 (61배 증가)**
- ✅ **각 구간별 245~2,251개 샘플 확보**
- ✅ **통계적 검정력 문제 완전 해결**
- **결과: 분기별과 일별 결과가 일치하여 신뢰도 크게 향상**

#### 7.1.3 생존 편향

- S&P 500 구성 종목은 시간에 따라 변함
- 낙오한 기업은 제외되므로 수익률이 과대평가될 수 있음
- 하지만 P/E 신호는 상대적 비교이므로 영향은 제한적

### 7.2 실제 투자 환경에서의 의미

#### 7.2.1 예상치 정확도 의존성

본 연구에서 제시한 "Forward Operating P/E의 우수한 예측력"과 "P/E ≈ 21 임계점"은 **백테스팅 환경에서만 유효**하며, 실제 투자에서는 다음과 같은 한계를 가진다:

1. **예상치 정확도 의존성:** 예상치가 정확할수록 예측력이 높아지지만, 예상치 오차가 크면 예측력이 급격히 감소
2. **실전 적용의 어려움:** 백테스팅에서 발견된 강한 신호가 실제 환경에서는 거의 무의미한 수준으로 감소
3. **차별점의 한계:** 본 연구가 강조한 "Forward Operating의 우수성"은 실측치 환경에서만 유효하며, 예상치 환경에서는 Mixed Operating, TTM Operating과 큰 차이가 없음

#### 7.2.2 모델 한계

**예측 정확도의 한계:**
- 백테스팅에서도 61-63% 정확도 (37-39% 오류율)
- 실제 환경에서는 더 낮을 것으로 예상

**블랙스완 이벤트:**
- 2008 금융위기, 2020 COVID-19 같은 극단 사건은 모델로 포착 불가
- 이런 시기에는 P/E가 무의미해질 수 있음 (EPS 폭락)

**구조적 변화:**
- 미래가 과거와 다를 수 있음
- AI 혁명, 금리 정상화 등으로 P/E 구조가 바뀔 가능성

### 7.3 P/E 기반 단순 판단의 위험성

#### 7.3.1 연구의 학술적 의의

본 연구는 다음과 같은 학술적 기여를 한다:

1. **백테스팅과 실제 투자 환경의 차이를 실증적으로 보여줌**
   - 백테스팅에서 발견된 강한 신호가 실제 환경에서는 약화될 수 있음을 증명
   - 예상치 오차가 예측 모델의 성능에 미치는 영향을 정량화

2. **P/E 지표의 한계를 명확히 제시**
   - P/E가 단독으로 사용될 때의 한계를 보여줌
   - 예상치 기반 P/E의 예측력이 실측치 기반보다 현저히 낮음을 증명

3. **투자 의사결정에 대한 경고**
   - 단일 지표에 의존한 투자 결정의 위험성
   - 백테스팅 결과를 맹신하지 말아야 함을 강조

#### 7.3.2 연구의 실무적 의의

본 연구는 실무 투자자들에게 다음과 같은 중요한 교훈을 제공한다:

1. **백테스팅 결과의 한계 인식**
   - 백테스팅에서 좋은 성과를 보인 전략이라도 실제 환경에서는 다를 수 있음
   - 예상치 오차를 고려하지 않은 백테스팅은 과도하게 낙관적인 결과를 보일 수 있음

2. **다각도 분석의 중요성**
   - 단일 지표(P/E)에 의존하지 말고 다양한 지표와 정보를 종합적으로 고려
   - 예상치의 정확도와 신뢰성을 함께 평가

3. **투자 철학의 재검토**
   - "고평가/저평가"라는 단순한 이분법적 사고의 한계
   - 시장은 복잡하며, 단일 지표로 모든 것을 설명할 수 없음

4. **예외적 발견: Trailing-like Operating P/E의 시장 저점 포착 능력**
   - 전반적인 한계에도 불구하고, Trailing-like Operating [Q(-3)+Q(-2)+Q(-1)+Q(0)] P/E가 -1.5σ 이하로 하락할 때 시장 저점을 효과적으로 식별하는 것으로 나타남
   - Trailing-like Operating은 과거 3분기 실측치와 현재 분기 예측치를 혼합한 형태로, 완전히 결과론적이지 않으면서도 예상치 오차의 영향을 상대적으로 덜 받는 특성을 가짐 (백테스팅의 TTM Operating과는 다름)
   - 시장의 극단적 비관 구간을 포착하는 데 유용한 참고 지표로 활용 가능
   - 단, 단일 지표에 의존하지 말고 다른 지표와 종합적으로 판단해야 함

### 7.4 향후 연구 방향

1. **예상치 정확도 분석:** 예상치 오차가 P/E 예측력에 미치는 영향을 정량화
2. **예상치 보정 모델:** 예상치의 체계적 오차를 보정하여 예측력 향상 방안 모색
3. **실시간 검증:** 실제 예상치를 사용한 장기 실전 검증을 통한 예측력 재평가

---

## 8. 결론: 연구의 진정한 의의

### 8.1 연구 요약

본 연구는 Operating Earnings 기반 3가지 P/E 정의를 분기별(148개)과 일별(9,003개) 데이터로 비교 분석하여 다음을 발견하였다:

1. **Operating vs As Reported 선택이 중요:**
   - Operating Earnings가 모든 기간에서 예측력 우수
   - 12개월 상관계수: -0.620 vs -0.590 (차이 0.03)
   - 일회성 항목이 통계를 왜곡 (특히 2000년 닷컴버블, 2008년 금융위기, 2020년 팬데믹)

2. **백테스팅에서 Forward Operating [Q'(1)+Q'(2)+Q'(3)+Q'(4)]이 가장 우수:** 
   - 분기별: 63.4% 예측 정확도, Low P/E가 High P/E 대비 15.31%p 높은 수익
   - 일별: 62.3% 예측 정확도, Low P/E가 High P/E 대비 14.37%p 높은 수익
   - 두 방법 모두 일관된 우수성 확인

3. **실제 예상치 환경에서는 예측력이 급격히 감소:**
   - 상관계수: -0.623 → -0.132 (79% 감소)
   - 스프레드: +20.68%p → +1.99%p (90% 감소)
   - Mixed Operating과 TTM Operating은 음수로 전환되어 역효과 발생

4. **Trailing-like Operating P/E의 시장 저점 포착 능력:**
   - Trailing-like Operating [Q(-3)+Q(-2)+Q(-1)+Q(0)] P/E가 -1.5σ 이하로 하락할 때 주요 시장 저점을 효과적으로 식별
   - Trailing-like Operating은 과거 3분기 실측치와 현재 분기 예측치를 혼합한 형태로, 완전히 결과론적이지 않으면서도 예상치 오차의 영향을 상대적으로 덜 받는 특성을 가짐 (백테스팅의 TTM Operating과는 다름)
   - 시장의 극단적 비관 구간을 포착하는 데 유용한 참고 지표로 활용 가능

### 8.2 연구의 진정한 의의

본 연구는 **P/E로 시장 타이밍이 가능하다**는 것을 증명하기보다는, **P/E 기반 단순 판단의 위험성**을 보여주는 것이 진정한 의의이다.

**핵심 발견:**

백테스팅에서는 강한 예측력을 보였던 P/E가 실제 예상치 환경에서는 거의 무의미한 수준으로 감소한다는 발견은, 투자자들이 단일 지표에 의존하지 말고 더 신중하고 종합적인 접근을 해야 함을 시사한다.

**중요한 경고:**

본 연구의 백테스팅 결과는 **과거 실측치를 사용한 이상적인 환경**에서의 결과이다. 실제 예상치를 사용한 분석에서는 상관계수가 -0.623에서 -0.132로 급격히 감소하고, 스프레드도 +20.68%p에서 +1.99%p로 감소하여 거의 무의미한 수준이 된다.

따라서 본 연구의 백테스팅 결과를 맹신하여 "P/E가 높으면 고평가이므로 위험하고, 낮으면 저평가이므로 찬스다"라는 단순한 논리로 투자 결정을 내리는 것은 위험하다. P/E는 참고 지표일 뿐이며, 예상치의 정확도와 신뢰성을 함께 고려하고, 다른 지표와 종합적으로 판단해야 한다.

**예외적 발견:**

다만, 한 가지 주목할 만한 예외는 **Trailing-like Operating [Q(-3)+Q(-2)+Q(-1)+Q(0)] P/E가 -1.5σ 이하로 하락할 때 시장 저점을 효과적으로 식별**한다는 발견이다. Trailing-like Operating은 과거 3분기 실측치와 현재 분기 예측치를 혼합한 형태로, 완전히 결과론적이지 않으면서도 예상치 오차의 영향을 상대적으로 덜 받는 특성을 가진다 (백테스팅의 TTM Operating과는 다름). 이는 전반적인 한계에도 불구하고 특정 P/E 정의가 특정 용도(시장 저점 식별)에서는 유용할 수 있음을 시사한다. 그러나 이 역시 단일 지표에 의존하지 말고 다른 지표와 종합적으로 판단해야 한다.

**본 연구의 진정한 가치는 백테스팅과 실제 투자 환경의 차이를 보여주고, 단일 지표에 의존한 투자 결정의 위험성을 경고하는 것이다.**

---

## References (참고문헌)

본 연구는 순수 실증 데이터 분석에 기반하여 수행되었으며, 외부 학술 문헌을 직접 참조하지 않았습니다.

**Data Sources:**
- **가격 데이터:** Yahoo Finance API (yfinance Python library) - S&P 500 Index (^GSPC)
- **EPS 데이터:** S&P Global - S&P Dow Jones Indices
  - 출처: [S&P 500 EPS Estimates](https://www.spglobal.com/spdji/en/documents/additional-material/sp-500-eps-est.xlsx)
  - 제공: S&P Dow Jones Indices LLC
- **예상치 데이터:** FactSet PDF에서 추출한 실제 예상치 데이터 (2016-2025)
- **분석 기간:** 1988년 12월 ~ 2025년 9월 (37년, 148분기)

**분석 도구:**
- Python 3.11+
- pandas, numpy, matplotlib
- 자체 개발 분석 스크립트

---

## Appendix A: 차트 설명

본 논문에는 6개의 주요 차트가 포함되어 있습니다:

**Figure 1: Operating vs As Reported Earnings (1988-2025)**
- 4개 패널: Forward 4Q EPS, Forward P/E, EPS 차이(M-N), P/E 차이(M-N)
- 위기 기간 음영 처리 (2000년 닷컴버블, 2008년 금융위기, 2020년 팬데믹)
- 목적: Operating Earnings 선택의 중요성 시각화
- 위치: Section 2.5

**Figure 2-1: Forward Operating 평균회귀 분석 (분기별)**
- 구조: 상단 P/E 시계열, 하단 P/E Z-score vs 미래 수익률 산점도
- 목적: 분기별 데이터로 기본 패턴 확인 (148개 관측치)
- 비교: Forward Operating (최고) > Mixed Operating > TTM Operating
- 위치: Section 4.1.4

**Figure 3: Forward Operating 일별 평균회귀 분석**
- 구조: Figure 2-1과 동일
- 목적: 일별 데이터로 검증 (9,003개 분석 샘플, 60배 증가)
- 위치: Section 4.2.3

**Figure 4: Forward Operating 상관계수 (일별 데이터)**
- P/E vs 1년 수익률 상관관계 시각화
- 목적: 9,003개 샘플로 강한 음의 상관관계 재확인
- 위치: Section 4.2.5

**Figure 5: S&P 500 주가와 모든 P/E 비율 (±1σ 범위 강조)**
- 3개 서브플롯: 각각 Mixed Operating [Q(0)+Q'(1)+Q'(2)+Q'(3)], Trailing-like Operating [Q(-3)+Q(-2)+Q(-1)+Q(0)], Forward Operating [Q'(1)+Q'(2)+Q'(3)+Q'(4)] P/E와 S&P 500 주가를 함께 표시
- 각 서브플롯에서 P/E가 ±1σ 범위를 벗어나는 구간을 빨간색(상단) 및 파란색(하단) 음영으로 강조
- 목적: 세 가지 P/E 정의의 시계열 패턴과 시장 가격의 관계 시각화
- 위치: Section 5.4.2

**Figure 6: S&P 500 주가와 모든 P/E 비율 (±1.5σ 범위 강조)**
- Figure 5와 동일한 구조로 ±1.5σ 범위를 벗어나는 구간 강조
- 목적: 더 엄격한 기준으로 극단적 가치 평가 구간 식별, 특히 Trailing-like Operating P/E의 시장 저점 포착 능력 확인
- 위치: Section 5.4.2

---

## Appendix B: 코드 재현성

본 연구의 모든 분석은 Python으로 구현되었으며, 주요 스크립트는 두 그룹으로 구성됩니다:

### **분기별 분석 스크립트 (Quarterly Analysis):**

1. `compare_pe_definitions.py`: 3가지 Operating P/E 비교 분석 및 차트 생성
2. `calculate_probabilities.py`: 예측 정확도 계산
3. `calculate_actual_returns.py`: 실제 수익률 차이 계산
4. `pe_quartile_analysis.py`: 구간별 분석 및 투자 가이드
5. `annualized_comparison_all.py`: 연율화 수익률 차이 비교
6. `compare_all_pe_quartiles.py`: 10년 vs 37년 구간별 비교
7. `trailing_pe_test.py`: TTM Operating 검증
8. `calculate_pe_win_probability.py`: 구간별×기간별 수익 확률 매트릭스 계산

### **일별 분석 스크립트 (Daily Analysis, 샘플 크기 60배 확대):**

1. `visualize_pe_mean_reversion_daily.py`: 일별 평균회귀 차트 생성 (Figure 3)
2. `visualize_pe_correlations.py`: P/E vs 수익률 상관관계 차트 (Figure 4)

### **실제 예상치 검증 스크립트:**

1. `create_true_daily_pe.py`: 실제 예상치 기반 일별 P/E 계산
2. `recalculate_performance_daily.py`: 실제 예상치 기반 성능 분석
3. `analyze_pe_flexible.py`: 유연한 분기 범위로 P/E 계산 (Q[0:4], Q[1:5], Q[-3:1] 등, Section 5.4 데이터 생성)

### **시장 타이밍 신호 분석 스크립트 (Section 5.4.3):**

1. `calculate_pe_mdd_match_rate.py`: P/E -1.5σ 구간과 MDD 극소점 일치율 계산 (±3일 윈도우, Table 5-6 데이터 생성)
2. `visualize_pe_mdd_alignment.py`: MDD bottoms와 P/E -1.5σ 구간 시각화 차트 생성

**재현 환경:**
- Python 3.11+
- pandas, numpy, matplotlib, yfinance, scipy, openpyxl, Pillow, boto3

**데이터:**
- 가격 데이터: 공개 (Yahoo Finance)
- EPS 데이터: 공개 (S&P Global)
- 예상치 데이터: FactSet PDF에서 추출

---

**본 논문은 학술 및 교육 목적으로 작성되었습니다. 투자 결정 시 반드시 자체적인 실사(Due Diligence)를 수행하시기 바랍니다.**

**면책조항:** 과거 성과가 미래 수익을 보장하지 않습니다. 백테스팅 결과는 실제 투자 환경과 다를 수 있으며, 실제 예상치를 사용한 분석에서는 예측력이 크게 감소합니다. 적절한 리스크 관리와 분산투자를 권장합니다.

---

**END OF PAPER**

© 2025 Seung-Gu Kang (강승구). All rights reserved.

